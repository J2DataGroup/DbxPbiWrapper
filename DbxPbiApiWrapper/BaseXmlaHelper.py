Possibly have Xmla endpoint code?
Try running DAX query such as INFO.PARTITIONSTORAGES
Create a generic wrapper around it.